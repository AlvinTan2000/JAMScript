<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Run</title>

  <meta name="author" content="Robert Wenger" />
  
  
  <meta name="description" content="Compiling and running a JAMScript program">
  

  <link rel="alternate" type="application/rss+xml" title="JAMScript - A Language and Middleware for Cloud of Moving Things" href="/JAMScript-beta/feed.xml" />

  
    
      <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.0/css/font-awesome.min.css" />
    
      
  
  
    
      <link rel="stylesheet" href="/JAMScript-beta/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/JAMScript-beta/css/bootstrap-social.css" />
    
      <link rel="stylesheet" href="/JAMScript-beta/css/main.css" />
    
    
  
  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

    
  
  

  

  <!-- Facebook OpenGraph tags -->
  <meta property="og:title" content="Run" />
  <meta property="og:type" content="website" />
  
  <meta property="og:url" content="http://anrl.github.io/JAMScript-beta/native-run/" />
  
  
  <meta property="og:image" content="" />
  
  
  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <meta name="twitter:creator" content="@" />
  <meta name="twitter:title" content="Run" />
  <meta name="twitter:description" content="Inside a Docker container JAMScript can be compiled and run without a local installation. This is the simplest way to try out JAMScript. You need a local installation only if you want to debug or develop JAMScript itself! The following are the preparatory steps to get Docker JAM tools working..." />
  
  
</head>


  <body>
  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://anrl.github.io/JAMScript-beta">JAMScript</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
      
        
          <li>
            
            





<a href="/JAMScript-beta/qstart">Quick Start</a>

          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Install</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="/JAMScript-beta/get-src">Get Source</a>

                
              
                
                  
            





<a href="/JAMScript-beta/linux">Linux</a>

                
              
                
                  
            





<a href="/JAMScript-beta/mac">Mac</a>

                
              
                
                  
            





<a href="/JAMScript-beta/docker">Docker</a>

                
              
                
                  
            





<a href="/JAMScript-beta/iot">Embedded Computers</a>

                
              
            </div>
          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Run</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="/JAMScript-beta/native-run">In Workstation</a>

                
              
                
                  
            





<a href="/JAMScript-beta/emulator-run">In Emulator</a>

                
              
            </div>
          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Language</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="/JAMScript-beta/jam-overview">Overview</a>

                
              
                
                  
            





<a href="/JAMScript-beta/jam-tasks">Remote/Local Tasks</a>

                
              
                
                  
            





<a href="/JAMScript-beta/data-per">Data Persistence</a>

                
              
                
                  
            





<a href="/JAMScript-beta/flow">Flow Computing</a>

                
              
                
                  
            





<a href="/JAMScript-beta/cond-tasks">Conditional Tasks</a>

                
              
            </div>
          </li>
        
        
        
          <li class="navlinks-container">
            <a class="navlinks-parent" href="javascript:void(0)">Examples</a>
            <div class="navlinks-children">
              
                
                  
            





<a href="/JAMScript-beta/jamshell">JAMShell</a>

                
              
                
                  
            





<a href="/JAMScript-beta/parking-spot">Parking Spot App</a>

                
              
            </div>
          </li>
        
        
      </ul>
    </div>

	

  </div>
</nav>


    <!-- TODO this file has become a mess, refactor it -->





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-heading">
          <h1>Run</h1>
		  
		    
            <hr class="small">
            <span class="page-subheading">Compiling and running a JAMScript program</span>
			
		  
		  
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>




<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <h2 id="inside-a-docker-container">Inside a Docker container</h2>

<p>JAMScript can be compiled and run without a local installation. This is the simplest way to try out JAMScript. You need a local installation only if you want to debug or develop JAMScript itself! The following are the preparatory steps to get Docker JAM tools working in your system.</p>

<ol>
  <li>Download <strong>JAMTools</strong> into a local directory called <code class="highlighter-rouge">tools</code> like <code class="highlighter-rouge">git clone https://github.com/anrl/JAMTools tools</code>.</li>
  <li>Add the <code class="highlighter-rouge">tools</code> directory to your execution path. This way <code class="highlighter-rouge">djam</code> and <code class="highlighter-rouge">jam</code> tools are available for you.</li>
  <li>Make <code class="highlighter-rouge">docker</code> run without <code class="highlighter-rouge">sudo</code>.</li>
  <li>Test that you actually completed Step 3 successfully. Use a command like <code class="highlighter-rouge">docker ps</code> and see whether it runs.</li>
  <li>Pull the docker container with JAMScript. Use <code class="highlighter-rouge">djam pull mahes25/jamscript</code>.</li>
</ol>

<p>Everything should be setup at this point. Type <code class="highlighter-rouge">djam</code> or <code class="highlighter-rouge">jam</code> and you should see a menu of sub commands available under each of them.</p>

<p>To compile a JAMScript program, do the following.
1. Write or get a JAMScript program. The easiest is to download the <strong>JAMSamples</strong>. Run <code class="highlighter-rouge">git clone https://github.com/anrl/JAMSamples samples</code> to download many example programs into a <code class="highlighter-rouge">samples</code> folder.
2. Change to a folder containing a valid JAMScript program. <code class="highlighter-rouge">cd samples/JData/String_Log</code> will change to the folder containing the string logging example.
3. To compile this program: <code class="highlighter-rouge">djam compile stringlog.*</code>.
4. After a successful compile, you should see <code class="highlighter-rouge">stringlog.jxe</code> in the folder. If not, the compilation did not succeed. You should have seen some error messages in the console to that effect.
5. Once you have compiled the sample program, you can run the program in different ways: in a device, fog, or cloud. When you run in a device, you can specify different number of C nodes as well. By default, the <code class="highlighter-rouge">djam run</code> sub command creates a single C node.</p>

<p>To run a device using the <code class="highlighter-rouge">stringlog.jxe</code> with 2 C nodes under the app name <code class="highlighter-rouge">q5</code> in background, use the following command.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>djam run stringlog.jxe --num<span class="o">=</span>2 --app<span class="o">=</span>q5 --bg
</code></pre>
</div>
<p>To see the status of the docker JAMScript execution, run the following command.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>djam list
</code></pre>
</div>
<p>You should see something like the following.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>      ID         NAME      PROGRAM         HOST         D-STORE       TYPE C-NODES    TMUX-ID

      q5           q5    stringlog ec0cd9fa0887     docker:6379      cloud      -- u-501-cloud-5-cloud
      q5           q5    stringlog ad38d5fb718a     docker:6379     device       2 u-501-device-13-dev
      q5           q5    stringlog 4e0c4d9a7732     docker:6379     device       1 u-501-device-17-dev
      q5           q5    stringlog 443981d1dbbd     docker:6379     device       1 u-501-device-19-dev
      q5           q5    stringlog 7059b7d955a6     docker:6379     device       1 u-501-device-21-dev
      q5           q5    stringlog cf46d982d28b     docker:6379     device       1 u-501-device-25-dev
      q5           q5    stringlog e8d1605639d9     docker:6379     device       1 u-501-device-27-dev
      q5           q5    stringlog 79a02ca4934d     docker:6379     device       1 u-501-device-29-dev
      q5           q5    stringlog f011f39a80d8     docker:6379     device       1 u-501-device-31-dev
      q5           q5    stringlog e9fe93e89c71     docker:6379     device       1 u-501-device-33-dev
      q5           q5    stringlog c3cf5c274ab9     docker:6379     device       1 u-501-device-35-dev
      q5           q5    stringlog 45c292e451de     docker:6379        fog      -- u-501-fog-7-fog
</code></pre>
</div>

<p>The second line corresponds to the device created by the previously issued command. It is created under the <code class="highlighter-rouge">ID</code> <code class="highlighter-rouge">q5</code>. Also, the <code class="highlighter-rouge">NAME</code> is same as the <code class="highlighter-rouge">ID</code>. The <code class="highlighter-rouge">HOST</code> gives the docker <code class="highlighter-rouge">ID</code> for the container running the device. The <code class="highlighter-rouge">D-STORE</code> shows the URL for the data depot used by the device. By default the <code class="highlighter-rouge">djam</code> puts a data depot inside each container at the default port. The <code class="highlighter-rouge">TMUX-ID</code> shows the <code class="highlighter-rouge">tmux</code> terminal that runs the program. To connect to the terminal issue the
following command.
<code class="highlighter-rouge">shell
jam term u-501-device-13-dev
</code></p>

<p>To detach from the terminal, press <strong>Ctrl-B</strong> and <strong>d</strong>. Some <code class="highlighter-rouge">djam</code> subcommands and interchangeable with the <code class="highlighter-rouge">jam</code>  subcommands (e.g., <code class="highlighter-rouge">jam term</code>
    <code class="highlighter-rouge">djam term</code> are the same).</p>

<p>You can start a whole topology using a script like the following.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>djam init --zones<span class="o">=</span>3 --indelay<span class="o">=</span>3:1 --outdelay<span class="o">=</span>5:3 --cldelay<span class="o">=</span>30:5

djam run stringlog.jxe --cloud --app<span class="o">=</span>q5 --bg

<span class="k">for </span>i <span class="k">in</span> <span class="sb">`</span>seq 1 3<span class="sb">`</span>; <span class="k">do
    </span>djam run stringlog.jxe --fog --app<span class="o">=</span>q5 --bg
<span class="k">done

for </span>i <span class="k">in</span> <span class="sb">`</span>seq 1 12<span class="sb">`</span>; <span class="k">do
    </span>djam run stringlog.jxe --app<span class="o">=</span>q5  --bg
<span class="k">done</span>
</code></pre>
</div>

<p>The above script, is setting up a network with three zones. The <code class="highlighter-rouge">--indelay</code> in the first line is specifying the delay within a zone.
The <code class="highlighter-rouge">--outdelay</code> is specifying the delay across two different zones. The <code class="highlighter-rouge">--cldelay</code> parameter specifies the delay between the cloud and
a machine (fog or device) in a zone.
You will notice that all machines (cloud, fogs, and devices) are started with the same application name (i.e., <code class="highlighter-rouge">q5</code>). This is necessary for
the nodes to create a single topology. You can delete all nodes in the topology, using the following command.
<code class="highlighter-rouge">shell
djam kill q5
</code></p>

<p>If you want to see how the delay is setup among the nodes, use the <code class="highlighter-rouge">djam test</code> command. It should create a <strong>test</strong> topology of bare nodes (i.e.,
    no JAMScript program is running in them). You can see them running by issuing the <code class="highlighter-rouge">docker ps</code> command, they should have <code class="highlighter-rouge">-test</code> in their names.
    Log in to a device, fog, and cloud test node and run a ping to a corresponding test node. You can see the network delay. To obtain the
    IP address of a node, run <code class="highlighter-rouge">hostname -I</code> while in the node.</p>

<h2 id="on-the-local-machine">On the local machine</h2>

<p>You can run JAMScript programs natively in Linux (Ubuntu), MacOS, or Rasberry Pi (Raspbian Linux). To run natively, you need to install JAMScript
on the local machine following the instructions under Install. After that, follow the steps below to get JAMScript programs running on yoru machine.</p>

<p><strong>To be completed.</strong></p>

	    
    </div>
  </div>
</div>


    <footer>
  <div class="container beautiful-jekyll-footer">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
          <li>
            <a href="https://github.com/wenger" title="GitHub">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
      
		  
          <li>
            <a href="mailto:robert.wenger@mail.mcgill.ca" title="Email me">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
		  
		  
		  
      
      
      
      
		  
        </ul>
        <p class="copyright text-muted">
		  Robert Wenger
		  &nbsp;&bull;&nbsp;
		  2018

		  
	    </p>
	        <!-- Please don't remove this, keep my open source work credited :) -->
		<p class="theme-by text-muted">
		  Theme by
		  <a href="http://deanattali.com/beautiful-jekyll/">beautiful-jekyll</a>
		</p>
      </div>
    </div>
  </div>
</footer>

  
    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/JAMScript-beta/js/jquery-1.11.2.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/JAMScript-beta/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/JAMScript-beta/js/main.js"></script>
    
  




  
  </body>
</html>
